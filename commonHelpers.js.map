{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst API_KEY = \"44872402-0762bbf0a5ccd686fb6258473\";\nconst BASE_URL = \"https://pixabay.com/api/\";\n\nconst searchForm = document.getElementById(\"search-form\");\nconst gallery = document.getElementById(\"gallery\");\nconst loader = document.getElementById(\"loader\");\nconst loadMoreBtn = document.getElementById(\"load-more-btn\");\nlet query = \"\";\nlet page = 1;\nlet totalHits = 0;\n\nconst fetchImages = async (query, page = 1) => {\n  try {\n    const response = await axios.get(`${BASE_URL}`, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: page,\n        per_page: 40,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw new Error(error.response.status);\n  }\n};\n\nconst createImageMarkup = images => {\n  return images\n    .map(\n      image => `\n            <li class=\"list-item\">\n                <a href=\"${image.largeImageURL}\">\n                    <img class=\"card-image\"\n                    src=\"${image.webformatURL}\"\n                    alt=\"${image.tags}\"\n                    width=\"360\">\n                </a>\n                <ul class=\"card-description-list\">\n                    <li class=\"card-description-item\">\n                        <h3 class=\"card-description-title\">Likes</h3>\n                        <p class=\"card-description-value\">${image.likes}</p>\n                    </li>\n                    <li class=\"card-description-item\">\n                        <h3 class=\"card-description-title\">Views</h3>\n                        <p class=\"card-description-value\">${image.views}</p>\n                    </li>\n                    <li class=\"card-description-item\">\n                        <h3 class=\"card-description-title\">Comments</h3>\n                        <p class=\"card-description-value\">${image.comments}</p>\n                    </li>\n                    <li class=\"card-description-item\">\n                        <h3 class=\"card-description-title\">Downloads</h3>\n                        <p class=\"card-description-value\">${image.downloads}</p>\n                    </li>\n                </ul>\n            </li>\n        `\n    )\n    .join(\"\");\n};\n\nconst displayImages = images => {\n  const markup = createImageMarkup(images);\n  gallery.insertAdjacentHTML(\"beforeend\", markup);\n  const lightbox = new SimpleLightbox(\".gallery-link\", {\n    captionsData: \"alt\",\n    captionDelay: 250,\n    captionPosition: \"bottom\",\n  });\n  lightbox.refresh();\n};\n\nconst showError = message => {\n  iziToast.error({\n    title: \"Error\",\n    message: message,\n  });\n};\n\nconst showInfo = message => {\n  iziToast.info({\n    title: \"Info\",\n    message: message,\n  });\n};\n\nconst handleSearchFormSubmit = async event => {\n  event.preventDefault();\n  query = event.target.elements.query.value.trim();\n\n  if (!query) return;\n\n  gallery.innerHTML = \"\";\n  loadMoreBtn.style.display = \"none\";\n  loader.style.display = \"flex\";\n  page = 1;\n\n  try {\n    const data = await fetchImages(query, page);\n    const images = data.hits;\n    totalHits = data.totalHits;\n\n    if (images.length === 0) {\n      showError(\n        \"Sorry, there are no images matching your search query. Please try again!\"\n      );\n    } else {\n      displayImages(images);\n      if (totalHits > images.length) {\n        loadMoreBtn.style.display = \"block\";\n      }\n    }\n  } catch (error) {\n    showError(\"Something went wrong. Please try again later.\");\n  } finally {\n    loader.style.display = \"none\";\n  }\n};\n\nconst handleLoadMoreBtnClick = async () => {\n  page += 1;\n  loader.style.display = \"flex\";\n\n  try {\n    const data = await fetchImages(query, page);\n    const images = data.hits;\n\n    if (images.length === 0) {\n      loadMoreBtn.style.display = \"none\";\n      showInfo(\"We're sorry, but you've reached the end of search results.\");\n    } else {\n      displayImages(images);\n      if (page * 40 >= totalHits) {\n        loadMoreBtn.style.display = \"none\";\n        showInfo(\"We're sorry, but you've reached the end of search results.\");\n      }\n\n      const { height: cardHeight } = document\n        .querySelector(\".gallery-item\")\n        .getBoundingClientRect();\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n      });\n    }\n  } catch (error) {\n    showError(\"Something went wrong. Please try again later.\");\n  } finally {\n    loader.style.display = \"none\";\n  }\n};\n\nsearchForm.addEventListener(\"submit\", handleSearchFormSubmit);\nloadMoreBtn.addEventListener(\"click\", handleLoadMoreBtnClick);"],"names":["API_KEY","BASE_URL","searchForm","gallery","loader","loadMoreBtn","query","page","totalHits","fetchImages","axios","error","createImageMarkup","images","image","displayImages","markup","SimpleLightbox","showError","message","iziToast","showInfo","handleSearchFormSubmit","event","data","handleLoadMoreBtnClick","cardHeight"],"mappings":"owBAMA,MAAMA,EAAU,qCACVC,EAAW,2BAEXC,EAAa,SAAS,eAAe,aAAa,EAClDC,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAS,SAAS,eAAe,QAAQ,EACzCC,EAAc,SAAS,eAAe,eAAe,EAC3D,IAAIC,EAAQ,GACRC,EAAO,EACPC,EAAY,EAEhB,MAAMC,EAAc,MAAOH,EAAOC,EAAO,IAAM,CAC7C,GAAI,CAYF,OAXiB,MAAMG,EAAM,IAAI,GAAGT,CAAQ,GAAI,CAC9C,OAAQ,CACN,IAAKD,EACL,EAAGM,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,EACX,CACP,CAAK,GACe,IACjB,OAAQI,EAAO,CACd,MAAM,IAAI,MAAMA,EAAM,SAAS,MAAM,CACtC,CACH,EAEMC,EAAoBC,GACjBA,EACJ,IACCC,GAAS;AAAA;AAAA,2BAEYA,EAAM,aAAa;AAAA;AAAA,2BAEnBA,EAAM,YAAY;AAAA,2BAClBA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4DAMuBA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,4DAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,4DAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,4DAIdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,SAKtE,EACA,KAAK,EAAE,EAGNC,EAAgBF,GAAU,CAC9B,MAAMG,EAASJ,EAAkBC,CAAM,EACvCV,EAAQ,mBAAmB,YAAaa,CAAM,EAC7B,IAAIC,EAAe,gBAAiB,CACnD,aAAc,MACd,aAAc,IACd,gBAAiB,QACrB,CAAG,EACQ,QAAO,CAClB,EAEMC,EAAYC,GAAW,CAC3BC,EAAS,MAAM,CACb,MAAO,QACP,QAASD,CACb,CAAG,CACH,EAEME,EAAWF,GAAW,CAC1BC,EAAS,KAAK,CACZ,MAAO,OACP,QAASD,CACb,CAAG,CACH,EAEMG,EAAyB,MAAMC,GAAS,CAI5C,GAHAA,EAAM,eAAc,EACpBjB,EAAQiB,EAAM,OAAO,SAAS,MAAM,MAAM,OAEtC,EAACjB,EAEL,CAAAH,EAAQ,UAAY,GACpBE,EAAY,MAAM,QAAU,OAC5BD,EAAO,MAAM,QAAU,OACvBG,EAAO,EAEP,GAAI,CACF,MAAMiB,EAAO,MAAMf,EAAYH,EAAOC,CAAI,EACpCM,EAASW,EAAK,KACpBhB,EAAYgB,EAAK,UAEbX,EAAO,SAAW,EACpBK,EACE,0EACR,GAEMH,EAAcF,CAAM,EAChBL,EAAYK,EAAO,SACrBR,EAAY,MAAM,QAAU,SAGjC,MAAe,CACda,EAAU,+CAA+C,CAC7D,QAAY,CACRd,EAAO,MAAM,QAAU,MACxB,EACH,EAEMqB,EAAyB,SAAY,CACzClB,GAAQ,EACRH,EAAO,MAAM,QAAU,OAEvB,GAAI,CAEF,MAAMS,GADO,MAAMJ,EAAYH,EAAOC,CAAI,GACtB,KAEpB,GAAIM,EAAO,SAAW,EACpBR,EAAY,MAAM,QAAU,OAC5BgB,EAAS,4DAA4D,MAChE,CACLN,EAAcF,CAAM,EAChBN,EAAO,IAAMC,IACfH,EAAY,MAAM,QAAU,OAC5BgB,EAAS,4DAA4D,GAGvE,KAAM,CAAE,OAAQK,CAAU,EAAK,SAC5B,cAAc,eAAe,EAC7B,wBACH,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QAClB,CAAO,CACF,CACF,MAAe,CACdR,EAAU,+CAA+C,CAC7D,QAAY,CACRd,EAAO,MAAM,QAAU,MACxB,CACH,EAEAF,EAAW,iBAAiB,SAAUoB,CAAsB,EAC5DjB,EAAY,iBAAiB,QAASoB,CAAsB"}